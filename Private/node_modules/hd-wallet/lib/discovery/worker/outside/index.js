'use strict';

var cov_2flc3x3w85 = function () {
    var path = '/home/g/dev/hd-wallet/src/discovery/worker/outside/index.js',
        hash = '3d01c8a2ad669f2e9f192c1eb6bae4b278ac42c7',
        Function = function () {}.constructor,
        global = new Function('return this')(),
        gcv = '__coverage__',
        coverageData = {
        path: '/home/g/dev/hd-wallet/src/discovery/worker/outside/index.js',
        statementMap: {
            '0': {
                start: {
                    line: 42,
                    column: 8
                },
                end: {
                    line: 42,
                    column: 37
                }
            },
            '1': {
                start: {
                    line: 43,
                    column: 8
                },
                end: {
                    line: 43,
                    column: 45
                }
            },
            '2': {
                start: {
                    line: 45,
                    column: 8
                },
                end: {
                    line: 45,
                    column: 103
                }
            },
            '3': {
                start: {
                    line: 45,
                    column: 57
                },
                end: {
                    line: 45,
                    column: 75
                }
            },
            '4': {
                start: {
                    line: 45,
                    column: 84
                },
                end: {
                    line: 45,
                    column: 101
                }
            },
            '5': {
                start: {
                    line: 46,
                    column: 8
                },
                end: {
                    line: 46,
                    column: 31
                }
            },
            '6': {
                start: {
                    line: 47,
                    column: 8
                },
                end: {
                    line: 47,
                    column: 39
                }
            },
            '7': {
                start: {
                    line: 48,
                    column: 8
                },
                end: {
                    line: 48,
                    column: 61
                }
            },
            '8': {
                start: {
                    line: 64,
                    column: 28
                },
                end: {
                    line: 64,
                    column: 62
                }
            },
            '9': {
                start: {
                    line: 65,
                    column: 8
                },
                end: {
                    line: 75,
                    column: 11
                }
            },
            '10': {
                start: {
                    line: 76,
                    column: 8
                },
                end: {
                    line: 76,
                    column: 66
                }
            },
            '11': {
                start: {
                    line: 78,
                    column: 24
                },
                end: {
                    line: 78,
                    column: 89
                }
            },
            '12': {
                start: {
                    line: 78,
                    column: 60
                },
                end: {
                    line: 78,
                    column: 88
                }
            },
            '13': {
                start: {
                    line: 80,
                    column: 50
                },
                end: {
                    line: 80,
                    column: 69
                }
            },
            '14': {
                start: {
                    line: 82,
                    column: 70
                },
                end: {
                    line: 82,
                    column: 124
                }
            },
            '15': {
                start: {
                    line: 83,
                    column: 8
                },
                end: {
                    line: 83,
                    column: 19
                }
            },
            '16': {
                start: {
                    line: 89,
                    column: 8
                },
                end: {
                    line: 103,
                    column: 9
                }
            },
            '17': {
                start: {
                    line: 90,
                    column: 27
                },
                end: {
                    line: 90,
                    column: 57
                }
            },
            '18': {
                start: {
                    line: 91,
                    column: 12
                },
                end: {
                    line: 93,
                    column: 13
                }
            },
            '19': {
                start: {
                    line: 92,
                    column: 16
                },
                end: {
                    line: 92,
                    column: 53
                }
            },
            '20': {
                start: {
                    line: 94,
                    column: 12
                },
                end: {
                    line: 102,
                    column: 14
                }
            },
            '21': {
                start: {
                    line: 104,
                    column: 8
                },
                end: {
                    line: 104,
                    column: 58
                }
            },
            '22': {
                start: {
                    line: 108,
                    column: 8
                },
                end: {
                    line: 110,
                    column: 9
                }
            },
            '23': {
                start: {
                    line: 109,
                    column: 12
                },
                end: {
                    line: 109,
                    column: 61
                }
            },
            '24': {
                start: {
                    line: 111,
                    column: 8
                },
                end: {
                    line: 113,
                    column: 9
                }
            },
            '25': {
                start: {
                    line: 112,
                    column: 12
                },
                end: {
                    line: 112,
                    column: 81
                }
            },
            '26': {
                start: {
                    line: 112,
                    column: 73
                },
                end: {
                    line: 112,
                    column: 79
                }
            },
            '27': {
                start: {
                    line: 114,
                    column: 8
                },
                end: {
                    line: 117,
                    column: 9
                }
            },
            '28': {
                start: {
                    line: 115,
                    column: 12
                },
                end: {
                    line: 116,
                    column: 47
                }
            },
            '29': {
                start: {
                    line: 116,
                    column: 28
                },
                end: {
                    line: 116,
                    column: 32
                }
            },
            '30': {
                start: {
                    line: 116,
                    column: 40
                },
                end: {
                    line: 116,
                    column: 45
                }
            },
            '31': {
                start: {
                    line: 118,
                    column: 8
                },
                end: {
                    line: 118,
                    column: 70
                }
            },
            '32': {
                start: {
                    line: 127,
                    column: 8
                },
                end: {
                    line: 135,
                    column: 9
                }
            },
            '33': {
                start: {
                    line: 128,
                    column: 12
                },
                end: {
                    line: 132,
                    column: 13
                }
            },
            '34': {
                start: {
                    line: 129,
                    column: 16
                },
                end: {
                    line: 129,
                    column: 106
                }
            },
            '35': {
                start: {
                    line: 131,
                    column: 16
                },
                end: {
                    line: 131,
                    column: 60
                }
            },
            '36': {
                start: {
                    line: 134,
                    column: 12
                },
                end: {
                    line: 134,
                    column: 46
                }
            },
            '37': {
                start: {
                    line: 147,
                    column: 31
                },
                end: {
                    line: 147,
                    column: 111
                }
            },
            '38': {
                start: {
                    line: 149,
                    column: 8
                },
                end: {
                    line: 197,
                    column: 10
                }
            },
            '39': {
                start: {
                    line: 151,
                    column: 16
                },
                end: {
                    line: 153,
                    column: 17
                }
            },
            '40': {
                start: {
                    line: 152,
                    column: 20
                },
                end: {
                    line: 152,
                    column: 79
                }
            },
            '41': {
                start: {
                    line: 152,
                    column: 51
                },
                end: {
                    line: 152,
                    column: 77
                }
            },
            '42': {
                start: {
                    line: 155,
                    column: 16
                },
                end: {
                    line: 195,
                    column: 18
                }
            },
            '43': {
                start: {
                    line: 158,
                    column: 24
                },
                end: {
                    line: 193,
                    column: 25
                }
            },
            '44': {
                start: {
                    line: 159,
                    column: 28
                },
                end: {
                    line: 159,
                    column: 56
                }
            },
            '45': {
                start: {
                    line: 161,
                    column: 80
                },
                end: {
                    line: 161,
                    column: 92
                }
            },
            '46': {
                start: {
                    line: 164,
                    column: 54
                },
                end: {
                    line: 164,
                    column: 56
                }
            },
            '47': {
                start: {
                    line: 165,
                    column: 28
                },
                end: {
                    line: 185,
                    column: 31
                }
            },
            '48': {
                start: {
                    line: 166,
                    column: 76
                },
                end: {
                    line: 170,
                    column: 33
                }
            },
            '49': {
                start: {
                    line: 171,
                    column: 32
                },
                end: {
                    line: 184,
                    column: 33
                }
            },
            '50': {
                start: {
                    line: 171,
                    column: 59
                },
                end: {
                    line: 171,
                    column: 65
                }
            },
            '51': {
                start: {
                    line: 171,
                    column: 80
                },
                end: {
                    line: 171,
                    column: 105
                }
            },
            '52': {
                start: {
                    line: 173,
                    column: 36
                },
                end: {
                    line: 173,
                    column: 76
                }
            },
            '53': {
                start: {
                    line: 175,
                    column: 56
                },
                end: {
                    line: 175,
                    column: 65
                }
            },
            '54': {
                start: {
                    line: 176,
                    column: 36
                },
                end: {
                    line: 180,
                    column: 39
                }
            },
            '55': {
                start: {
                    line: 177,
                    column: 40
                },
                end: {
                    line: 179,
                    column: 41
                }
            },
            '56': {
                start: {
                    line: 178,
                    column: 44
                },
                end: {
                    line: 178,
                    column: 63
                }
            },
            '57': {
                start: {
                    line: 181,
                    column: 36
                },
                end: {
                    line: 183,
                    column: 37
                }
            },
            '58': {
                start: {
                    line: 181,
                    column: 66
                },
                end: {
                    line: 181,
                    column: 90
                }
            },
            '59': {
                start: {
                    line: 182,
                    column: 40
                },
                end: {
                    line: 182,
                    column: 77
                }
            },
            '60': {
                start: {
                    line: 187,
                    column: 28
                },
                end: {
                    line: 187,
                    column: 92
                }
            },
            '61': {
                start: {
                    line: 189,
                    column: 59
                },
                end: {
                    line: 191,
                    column: 29
                }
            },
            '62': {
                start: {
                    line: 192,
                    column: 28
                },
                end: {
                    line: 192,
                    column: 38
                }
            },
            '63': {
                start: {
                    line: 207,
                    column: 8
                },
                end: {
                    line: 210,
                    column: 9
                }
            },
            '64': {
                start: {
                    line: 208,
                    column: 12
                },
                end: {
                    line: 208,
                    column: 27
                }
            },
            '65': {
                start: {
                    line: 209,
                    column: 12
                },
                end: {
                    line: 209,
                    column: 58
                }
            }
        },
        fnMap: {
            '0': {
                name: '(anonymous_0)',
                decl: {
                    start: {
                        line: 34,
                        column: 4
                    },
                    end: {
                        line: 34,
                        column: 5
                    }
                },
                loc: {
                    start: {
                        line: 41,
                        column: 6
                    },
                    end: {
                        line: 49,
                        column: 5
                    }
                },
                line: 41
            },
            '1': {
                name: '(anonymous_1)',
                decl: {
                    start: {
                        line: 45,
                        column: 50
                    },
                    end: {
                        line: 45,
                        column: 51
                    }
                },
                loc: {
                    start: {
                        line: 45,
                        column: 57
                    },
                    end: {
                        line: 45,
                        column: 75
                    }
                },
                line: 45
            },
            '2': {
                name: '(anonymous_2)',
                decl: {
                    start: {
                        line: 45,
                        column: 77
                    },
                    end: {
                        line: 45,
                        column: 78
                    }
                },
                loc: {
                    start: {
                        line: 45,
                        column: 84
                    },
                    end: {
                        line: 45,
                        column: 101
                    }
                },
                line: 45
            },
            '3': {
                name: '(anonymous_3)',
                decl: {
                    start: {
                        line: 51,
                        column: 4
                    },
                    end: {
                        line: 51,
                        column: 5
                    }
                },
                loc: {
                    start: {
                        line: 62,
                        column: 56
                    },
                    end: {
                        line: 84,
                        column: 5
                    }
                },
                line: 62
            },
            '4': {
                name: '(anonymous_4)',
                decl: {
                    start: {
                        line: 78,
                        column: 54
                    },
                    end: {
                        line: 78,
                        column: 55
                    }
                },
                loc: {
                    start: {
                        line: 78,
                        column: 60
                    },
                    end: {
                        line: 78,
                        column: 88
                    }
                },
                line: 78
            },
            '5': {
                name: '(anonymous_5)',
                decl: {
                    start: {
                        line: 88,
                        column: 4
                    },
                    end: {
                        line: 88,
                        column: 5
                    }
                },
                loc: {
                    start: {
                        line: 88,
                        column: 49
                    },
                    end: {
                        line: 105,
                        column: 5
                    }
                },
                line: 88
            },
            '6': {
                name: '(anonymous_6)',
                decl: {
                    start: {
                        line: 107,
                        column: 4
                    },
                    end: {
                        line: 107,
                        column: 5
                    }
                },
                loc: {
                    start: {
                        line: 107,
                        column: 52
                    },
                    end: {
                        line: 119,
                        column: 5
                    }
                },
                line: 107
            },
            '7': {
                name: '(anonymous_7)',
                decl: {
                    start: {
                        line: 112,
                        column: 59
                    },
                    end: {
                        line: 112,
                        column: 60
                    }
                },
                loc: {
                    start: {
                        line: 112,
                        column: 73
                    },
                    end: {
                        line: 112,
                        column: 79
                    }
                },
                line: 112
            },
            '8': {
                name: '(anonymous_8)',
                decl: {
                    start: {
                        line: 116,
                        column: 22
                    },
                    end: {
                        line: 116,
                        column: 23
                    }
                },
                loc: {
                    start: {
                        line: 116,
                        column: 28
                    },
                    end: {
                        line: 116,
                        column: 32
                    }
                },
                line: 116
            },
            '9': {
                name: '(anonymous_9)',
                decl: {
                    start: {
                        line: 116,
                        column: 34
                    },
                    end: {
                        line: 116,
                        column: 35
                    }
                },
                loc: {
                    start: {
                        line: 116,
                        column: 40
                    },
                    end: {
                        line: 116,
                        column: 45
                    }
                },
                line: 116
            },
            '10': {
                name: '(anonymous_10)',
                decl: {
                    start: {
                        line: 121,
                        column: 4
                    },
                    end: {
                        line: 121,
                        column: 5
                    }
                },
                loc: {
                    start: {
                        line: 126,
                        column: 30
                    },
                    end: {
                        line: 136,
                        column: 5
                    }
                },
                line: 126
            },
            '11': {
                name: '(anonymous_11)',
                decl: {
                    start: {
                        line: 138,
                        column: 4
                    },
                    end: {
                        line: 138,
                        column: 5
                    }
                },
                loc: {
                    start: {
                        line: 146,
                        column: 43
                    },
                    end: {
                        line: 198,
                        column: 5
                    }
                },
                line: 146
            },
            '12': {
                name: '(anonymous_12)',
                decl: {
                    start: {
                        line: 150,
                        column: 32
                    },
                    end: {
                        line: 150,
                        column: 33
                    }
                },
                loc: {
                    start: {
                        line: 150,
                        column: 45
                    },
                    end: {
                        line: 196,
                        column: 13
                    }
                },
                line: 150
            },
            '13': {
                name: '(anonymous_13)',
                decl: {
                    start: {
                        line: 152,
                        column: 46
                    },
                    end: {
                        line: 152,
                        column: 47
                    }
                },
                loc: {
                    start: {
                        line: 152,
                        column: 51
                    },
                    end: {
                        line: 152,
                        column: 77
                    }
                },
                line: 152
            },
            '14': {
                name: '(anonymous_14)',
                decl: {
                    start: {
                        line: 157,
                        column: 20
                    },
                    end: {
                        line: 157,
                        column: 21
                    }
                },
                loc: {
                    start: {
                        line: 157,
                        column: 36
                    },
                    end: {
                        line: 194,
                        column: 21
                    }
                },
                line: 157
            },
            '15': {
                name: '(anonymous_15)',
                decl: {
                    start: {
                        line: 165,
                        column: 72
                    },
                    end: {
                        line: 165,
                        column: 73
                    }
                },
                loc: {
                    start: {
                        line: 165,
                        column: 92
                    },
                    end: {
                        line: 185,
                        column: 29
                    }
                },
                line: 165
            },
            '16': {
                name: '(anonymous_16)',
                decl: {
                    start: {
                        line: 171,
                        column: 54
                    },
                    end: {
                        line: 171,
                        column: 55
                    }
                },
                loc: {
                    start: {
                        line: 171,
                        column: 59
                    },
                    end: {
                        line: 171,
                        column: 65
                    }
                },
                line: 171
            },
            '17': {
                name: '(anonymous_17)',
                decl: {
                    start: {
                        line: 171,
                        column: 72
                    },
                    end: {
                        line: 171,
                        column: 73
                    }
                },
                loc: {
                    start: {
                        line: 171,
                        column: 80
                    },
                    end: {
                        line: 171,
                        column: 105
                    }
                },
                line: 171
            },
            '18': {
                name: '(anonymous_18)',
                decl: {
                    start: {
                        line: 176,
                        column: 107
                    },
                    end: {
                        line: 176,
                        column: 108
                    }
                },
                loc: {
                    start: {
                        line: 176,
                        column: 112
                    },
                    end: {
                        line: 180,
                        column: 37
                    }
                },
                line: 176
            },
            '19': {
                name: '(anonymous_19)',
                decl: {
                    start: {
                        line: 181,
                        column: 55
                    },
                    end: {
                        line: 181,
                        column: 56
                    }
                },
                loc: {
                    start: {
                        line: 181,
                        column: 66
                    },
                    end: {
                        line: 181,
                        column: 90
                    }
                },
                line: 181
            },
            '20': {
                name: '(anonymous_20)',
                decl: {
                    start: {
                        line: 205,
                        column: 94
                    },
                    end: {
                        line: 205,
                        column: 95
                    }
                },
                loc: {
                    start: {
                        line: 205,
                        column: 100
                    },
                    end: {
                        line: 205,
                        column: 103
                    }
                },
                line: 205
            },
            '21': {
                name: '(anonymous_21)',
                decl: {
                    start: {
                        line: 206,
                        column: 4
                    },
                    end: {
                        line: 206,
                        column: 5
                    }
                },
                loc: {
                    start: {
                        line: 206,
                        column: 24
                    },
                    end: {
                        line: 211,
                        column: 5
                    }
                },
                line: 206
            }
        },
        branchMap: {
            '0': {
                loc: {
                    start: {
                        line: 89,
                        column: 8
                    },
                    end: {
                        line: 103,
                        column: 9
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 89,
                        column: 8
                    },
                    end: {
                        line: 103,
                        column: 9
                    }
                }, {
                    start: {
                        line: 89,
                        column: 8
                    },
                    end: {
                        line: 103,
                        column: 9
                    }
                }],
                line: 89
            },
            '1': {
                loc: {
                    start: {
                        line: 91,
                        column: 12
                    },
                    end: {
                        line: 93,
                        column: 13
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 91,
                        column: 12
                    },
                    end: {
                        line: 93,
                        column: 13
                    }
                }, {
                    start: {
                        line: 91,
                        column: 12
                    },
                    end: {
                        line: 93,
                        column: 13
                    }
                }],
                line: 91
            },
            '2': {
                loc: {
                    start: {
                        line: 108,
                        column: 8
                    },
                    end: {
                        line: 110,
                        column: 9
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 108,
                        column: 8
                    },
                    end: {
                        line: 110,
                        column: 9
                    }
                }, {
                    start: {
                        line: 108,
                        column: 8
                    },
                    end: {
                        line: 110,
                        column: 9
                    }
                }],
                line: 108
            },
            '3': {
                loc: {
                    start: {
                        line: 111,
                        column: 8
                    },
                    end: {
                        line: 113,
                        column: 9
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 111,
                        column: 8
                    },
                    end: {
                        line: 113,
                        column: 9
                    }
                }, {
                    start: {
                        line: 111,
                        column: 8
                    },
                    end: {
                        line: 113,
                        column: 9
                    }
                }],
                line: 111
            },
            '4': {
                loc: {
                    start: {
                        line: 114,
                        column: 8
                    },
                    end: {
                        line: 117,
                        column: 9
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 114,
                        column: 8
                    },
                    end: {
                        line: 117,
                        column: 9
                    }
                }, {
                    start: {
                        line: 114,
                        column: 8
                    },
                    end: {
                        line: 117,
                        column: 9
                    }
                }],
                line: 114
            },
            '5': {
                loc: {
                    start: {
                        line: 127,
                        column: 8
                    },
                    end: {
                        line: 135,
                        column: 9
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 127,
                        column: 8
                    },
                    end: {
                        line: 135,
                        column: 9
                    }
                }, {
                    start: {
                        line: 127,
                        column: 8
                    },
                    end: {
                        line: 135,
                        column: 9
                    }
                }],
                line: 127
            },
            '6': {
                loc: {
                    start: {
                        line: 128,
                        column: 12
                    },
                    end: {
                        line: 132,
                        column: 13
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 128,
                        column: 12
                    },
                    end: {
                        line: 132,
                        column: 13
                    }
                }, {
                    start: {
                        line: 128,
                        column: 12
                    },
                    end: {
                        line: 132,
                        column: 13
                    }
                }],
                line: 128
            },
            '7': {
                loc: {
                    start: {
                        line: 151,
                        column: 16
                    },
                    end: {
                        line: 153,
                        column: 17
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 151,
                        column: 16
                    },
                    end: {
                        line: 153,
                        column: 17
                    }
                }, {
                    start: {
                        line: 151,
                        column: 16
                    },
                    end: {
                        line: 153,
                        column: 17
                    }
                }],
                line: 151
            },
            '8': {
                loc: {
                    start: {
                        line: 158,
                        column: 24
                    },
                    end: {
                        line: 193,
                        column: 25
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 158,
                        column: 24
                    },
                    end: {
                        line: 193,
                        column: 25
                    }
                }, {
                    start: {
                        line: 158,
                        column: 24
                    },
                    end: {
                        line: 193,
                        column: 25
                    }
                }],
                line: 158
            },
            '9': {
                loc: {
                    start: {
                        line: 171,
                        column: 32
                    },
                    end: {
                        line: 184,
                        column: 33
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 171,
                        column: 32
                    },
                    end: {
                        line: 184,
                        column: 33
                    }
                }, {
                    start: {
                        line: 171,
                        column: 32
                    },
                    end: {
                        line: 184,
                        column: 33
                    }
                }],
                line: 171
            },
            '10': {
                loc: {
                    start: {
                        line: 177,
                        column: 40
                    },
                    end: {
                        line: 179,
                        column: 41
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 177,
                        column: 40
                    },
                    end: {
                        line: 179,
                        column: 41
                    }
                }, {
                    start: {
                        line: 177,
                        column: 40
                    },
                    end: {
                        line: 179,
                        column: 41
                    }
                }],
                line: 177
            },
            '11': {
                loc: {
                    start: {
                        line: 181,
                        column: 36
                    },
                    end: {
                        line: 183,
                        column: 37
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 181,
                        column: 36
                    },
                    end: {
                        line: 183,
                        column: 37
                    }
                }, {
                    start: {
                        line: 181,
                        column: 36
                    },
                    end: {
                        line: 183,
                        column: 37
                    }
                }],
                line: 181
            },
            '12': {
                loc: {
                    start: {
                        line: 207,
                        column: 8
                    },
                    end: {
                        line: 210,
                        column: 9
                    }
                },
                type: 'if',
                locations: [{
                    start: {
                        line: 207,
                        column: 8
                    },
                    end: {
                        line: 210,
                        column: 9
                    }
                }, {
                    start: {
                        line: 207,
                        column: 8
                    },
                    end: {
                        line: 210,
                        column: 9
                    }
                }],
                line: 207
            }
        },
        s: {
            '0': 0,
            '1': 0,
            '2': 0,
            '3': 0,
            '4': 0,
            '5': 0,
            '6': 0,
            '7': 0,
            '8': 0,
            '9': 0,
            '10': 0,
            '11': 0,
            '12': 0,
            '13': 0,
            '14': 0,
            '15': 0,
            '16': 0,
            '17': 0,
            '18': 0,
            '19': 0,
            '20': 0,
            '21': 0,
            '22': 0,
            '23': 0,
            '24': 0,
            '25': 0,
            '26': 0,
            '27': 0,
            '28': 0,
            '29': 0,
            '30': 0,
            '31': 0,
            '32': 0,
            '33': 0,
            '34': 0,
            '35': 0,
            '36': 0,
            '37': 0,
            '38': 0,
            '39': 0,
            '40': 0,
            '41': 0,
            '42': 0,
            '43': 0,
            '44': 0,
            '45': 0,
            '46': 0,
            '47': 0,
            '48': 0,
            '49': 0,
            '50': 0,
            '51': 0,
            '52': 0,
            '53': 0,
            '54': 0,
            '55': 0,
            '56': 0,
            '57': 0,
            '58': 0,
            '59': 0,
            '60': 0,
            '61': 0,
            '62': 0,
            '63': 0,
            '64': 0,
            '65': 0
        },
        f: {
            '0': 0,
            '1': 0,
            '2': 0,
            '3': 0,
            '4': 0,
            '5': 0,
            '6': 0,
            '7': 0,
            '8': 0,
            '9': 0,
            '10': 0,
            '11': 0,
            '12': 0,
            '13': 0,
            '14': 0,
            '15': 0,
            '16': 0,
            '17': 0,
            '18': 0,
            '19': 0,
            '20': 0,
            '21': 0
        },
        b: {
            '0': [0, 0],
            '1': [0, 0],
            '2': [0, 0],
            '3': [0, 0],
            '4': [0, 0],
            '5': [0, 0],
            '6': [0, 0],
            '7': [0, 0],
            '8': [0, 0],
            '9': [0, 0],
            '10': [0, 0],
            '11': [0, 0],
            '12': [0, 0]
        },
        _coverageSchema: '332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'
    },
        coverage = global[gcv] || (global[gcv] = {});

    if (coverage[path] && coverage[path].hash === hash) {
        return coverage[path];
    }

    coverageData.hash = hash;
    return coverage[path] = coverageData;
}();

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.WorkerDiscoveryHandler = undefined;

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _stream = require('../../../utils/stream');

var _channel = require('./channel');

var _bchaddrjs = require('bchaddrjs');

var _bchaddrjs2 = _interopRequireDefault(_bchaddrjs);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var WorkerDiscoveryHandler = exports.WorkerDiscoveryHandler = function () {
    function WorkerDiscoveryHandler(f, blockchain, addressSources, network, cashAddress, forceAddedTransactions) {
        var _this = this;

        _classCallCheck(this, WorkerDiscoveryHandler);

        this.forceAddedTransactions = [];
        this.counter = new TransactionCounter();
        cov_2flc3x3w85.f[0]++;
        cov_2flc3x3w85.s[0]++;

        this.blockchain = blockchain;
        cov_2flc3x3w85.s[1]++;
        this.addressSources = addressSources;

        cov_2flc3x3w85.s[2]++;
        this.workerChannel = new _channel.WorkerChannel(f, function (r) {
            cov_2flc3x3w85.f[1]++;
            cov_2flc3x3w85.s[3]++;
            return _this.getPromise(r);
        }, function (r) {
            cov_2flc3x3w85.f[2]++;
            cov_2flc3x3w85.s[4]++;
            return _this.getStream(r);
        });
        cov_2flc3x3w85.s[5]++;
        this.network = network;
        cov_2flc3x3w85.s[6]++;
        this.cashAddress = cashAddress;
        cov_2flc3x3w85.s[7]++;
        this.forceAddedTransactions = forceAddedTransactions;
    }

    // this array is the SAME object as in the WorkerDiscovery object
    // it will be changed here - this is intentional
    // we want to delete from this array if we actually see the tx in the wild


    _createClass(WorkerDiscoveryHandler, [{
        key: 'discovery',
        value: function discovery(ai, xpub, segwit, gap,

        // what (new Date().getTimezoneOffset()) returns
        // note that it is NEGATIVE from the UTC string timezone
        // so, UTC+2 timezone returns -120...
        timeOffset) {
            var _this2 = this;

            cov_2flc3x3w85.f[3]++;

            // $FlowIssue
            var webassembly = (cov_2flc3x3w85.s[8]++, typeof WebAssembly !== 'undefined');
            cov_2flc3x3w85.s[9]++;
            this.workerChannel.postToWorker({
                type: 'init',
                state: ai,
                network: this.network,
                webassembly: webassembly,
                xpub: xpub,
                segwit: segwit,
                cashAddress: this.cashAddress,
                gap: gap,
                timeOffset: timeOffset
            });
            cov_2flc3x3w85.s[10]++;
            this.workerChannel.postToWorker({ type: 'startDiscovery' });

            var promise = (cov_2flc3x3w85.s[11]++, this.workerChannel.resPromise(function () {
                cov_2flc3x3w85.f[4]++;
                cov_2flc3x3w85.s[12]++;
                return _this2.counter.finisher.emit();
            }));

            var stream = (cov_2flc3x3w85.s[13]++, this.counter.stream);

            var res = (cov_2flc3x3w85.s[14]++, _stream.StreamWithEnding.fromStreamAndPromise(stream, promise));
            cov_2flc3x3w85.s[15]++;
            return res;
        }
    }, {
        key: 'getStream',
        value: function getStream(p) {
            cov_2flc3x3w85.f[5]++;
            cov_2flc3x3w85.s[16]++;

            if (p.type === 'chunkTransactions') {
                cov_2flc3x3w85.b[0][0]++;

                var source = (cov_2flc3x3w85.s[17]++, this.addressSources[p.chainId]);
                cov_2flc3x3w85.s[18]++;
                if (p.chainId === 0) {
                    cov_2flc3x3w85.b[1][0]++;
                    cov_2flc3x3w85.s[19]++;

                    this.counter.setCount(p.pseudoCount);
                } else {
                    cov_2flc3x3w85.b[1][1]++;
                }
                cov_2flc3x3w85.s[20]++;
                return this.getChunkStream(source, p.firstIndex, p.lastIndex, p.startBlock, p.endBlock, p.chainId === 0, p.addresses);
            } else {
                cov_2flc3x3w85.b[0][1]++;
            }
            cov_2flc3x3w85.s[21]++;
            return _stream.Stream.simple('Unknown request ' + p.type);
        }
    }, {
        key: 'getPromise',
        value: function getPromise(p) {
            cov_2flc3x3w85.f[6]++;
            cov_2flc3x3w85.s[22]++;

            if (p.type === 'lookupBlockHash') {
                cov_2flc3x3w85.b[2][0]++;
                cov_2flc3x3w85.s[23]++;

                return this.blockchain.lookupBlockHash(p.height);
            } else {
                cov_2flc3x3w85.b[2][1]++;
            }
            cov_2flc3x3w85.s[24]++;
            if (p.type === 'lookupSyncStatus') {
                cov_2flc3x3w85.b[3][0]++;
                cov_2flc3x3w85.s[25]++;

                return this.blockchain.lookupSyncStatus().then(function (_ref) {
                    var height = _ref.height;
                    cov_2flc3x3w85.f[7]++;
                    cov_2flc3x3w85.s[26]++;
                    return height;
                });
            } else {
                cov_2flc3x3w85.b[3][1]++;
            }
            cov_2flc3x3w85.s[27]++;
            if (p.type === 'doesTransactionExist') {
                cov_2flc3x3w85.b[4][0]++;
                cov_2flc3x3w85.s[28]++;

                return this.blockchain.lookupTransaction(p.txid).then(function () {
                    cov_2flc3x3w85.f[8]++;
                    cov_2flc3x3w85.s[29]++;
                    return true;
                }, function () {
                    cov_2flc3x3w85.f[9]++;
                    cov_2flc3x3w85.s[30]++;
                    return false;
                });
            } else {
                cov_2flc3x3w85.b[4][1]++;
            }
            cov_2flc3x3w85.s[31]++;
            return Promise.reject(new Error('Unknown request ' + p.type));
        }
    }, {
        key: 'getChunkStream',
        value: function getChunkStream(source, firstIndex, lastIndex, startBlock, endBlock, add, addresses) {
            var _this3 = this;

            cov_2flc3x3w85.f[11]++;

            var addressPromise = (cov_2flc3x3w85.s[37]++, WorkerDiscoveryHandler.deriveAddresses(source, addresses, firstIndex, lastIndex));

            cov_2flc3x3w85.s[38]++;
            return _stream.Stream.fromPromise(addressPromise.then(function (addresses) {
                cov_2flc3x3w85.f[12]++;
                cov_2flc3x3w85.s[39]++;

                if (_this3.cashAddress) {
                    cov_2flc3x3w85.b[7][0]++;
                    cov_2flc3x3w85.s[40]++;

                    addresses = addresses.map(function (a) {
                        cov_2flc3x3w85.f[13]++;
                        cov_2flc3x3w85.s[41]++;
                        return _bchaddrjs2.default.toCashAddress(a);
                    });
                } else {
                    cov_2flc3x3w85.b[7][1]++;
                }

                cov_2flc3x3w85.s[42]++;
                return _this3.blockchain.lookupTransactionsStream(addresses, endBlock, startBlock).map(function (transactions) {
                    cov_2flc3x3w85.f[14]++;
                    cov_2flc3x3w85.s[43]++;

                    if (transactions instanceof Error) {
                        cov_2flc3x3w85.b[8][0]++;
                        cov_2flc3x3w85.s[44]++;

                        return transactions.message;
                    } else {
                        cov_2flc3x3w85.b[8][1]++;

                        var transactions_ = (cov_2flc3x3w85.s[45]++, transactions);

                        // code for handling forceAdded transactions
                        var addedTransactions = (cov_2flc3x3w85.s[46]++, []);
                        cov_2flc3x3w85.s[47]++;
                        _this3.forceAddedTransactions.slice().forEach(function (transaction, i) {
                            cov_2flc3x3w85.f[15]++;

                            var transaction_ = (cov_2flc3x3w85.s[48]++, _extends({}, transaction, {
                                height: null,
                                timestamp: null
                            }));
                            cov_2flc3x3w85.s[49]++;
                            if (transactions_.map(function (t) {
                                cov_2flc3x3w85.f[16]++;
                                cov_2flc3x3w85.s[50]++;
                                return t.hash;
                            }).some(function (hash) {
                                cov_2flc3x3w85.f[17]++;
                                cov_2flc3x3w85.s[51]++;
                                return transaction.hash === hash;
                            })) {
                                cov_2flc3x3w85.b[9][0]++;
                                cov_2flc3x3w85.s[52]++;

                                // transaction already came from blockchain again
                                _this3.forceAddedTransactions.slice(i, 1);
                            } else {
                                cov_2flc3x3w85.b[9][1]++;

                                var txAddresses = (cov_2flc3x3w85.s[53]++, new Set());
                                cov_2flc3x3w85.s[54]++;
                                transaction.inputAddresses.concat(transaction.outputAddresses).forEach(function (a) {
                                    cov_2flc3x3w85.f[18]++;
                                    cov_2flc3x3w85.s[55]++;

                                    if (a != null) {
                                        cov_2flc3x3w85.b[10][0]++;
                                        cov_2flc3x3w85.s[56]++;

                                        txAddresses.add(a);
                                    } else {
                                        cov_2flc3x3w85.b[10][1]++;
                                    }
                                });
                                cov_2flc3x3w85.s[57]++;
                                if (addresses.some(function (address) {
                                    cov_2flc3x3w85.f[19]++;
                                    cov_2flc3x3w85.s[58]++;
                                    return txAddresses.has(address);
                                })) {
                                    cov_2flc3x3w85.b[11][0]++;
                                    cov_2flc3x3w85.s[59]++;

                                    addedTransactions.push(transaction_);
                                } else {
                                    cov_2flc3x3w85.b[11][1]++;
                                }
                            }
                        });

                        cov_2flc3x3w85.s[60]++;
                        _this3.counter.setCount(_this3.counter.count + transactions.length);

                        var ci = (cov_2flc3x3w85.s[61]++, {
                            transactions: transactions.concat(addedTransactions), addresses: addresses
                        });
                        cov_2flc3x3w85.s[62]++;
                        return ci;
                    }
                });
            }));
        }
    }], [{
        key: 'deriveAddresses',
        value: function deriveAddresses(source, addresses, firstIndex, lastIndex) {
            cov_2flc3x3w85.f[10]++;
            cov_2flc3x3w85.s[32]++;

            if (addresses == null) {
                cov_2flc3x3w85.b[5][0]++;
                cov_2flc3x3w85.s[33]++;

                if (source == null) {
                    cov_2flc3x3w85.b[6][0]++;
                    cov_2flc3x3w85.s[34]++;

                    return Promise.reject(new Error('Cannot derive addresses in worker without webassembly'));
                } else {
                    cov_2flc3x3w85.b[6][1]++;
                    cov_2flc3x3w85.s[35]++;

                    return source.derive(firstIndex, lastIndex);
                }
            } else {
                cov_2flc3x3w85.b[5][1]++;
                cov_2flc3x3w85.s[36]++;

                return Promise.resolve(addresses);
            }
        }
    }]);

    return WorkerDiscoveryHandler;
}();

var TransactionCounter = function () {
    function TransactionCounter() {
        _classCallCheck(this, TransactionCounter);

        this.count = 0;
        this.emitter = new _stream.Emitter();
        this.finisher = new _stream.Emitter();
        this.stream = _stream.Stream.fromEmitterFinish(this.emitter, this.finisher, function () {
            cov_2flc3x3w85.f[20]++;
        });
    }

    _createClass(TransactionCounter, [{
        key: 'setCount',
        value: function setCount(i) {
            cov_2flc3x3w85.f[21]++;
            cov_2flc3x3w85.s[63]++;

            if (i > this.count) {
                cov_2flc3x3w85.b[12][0]++;
                cov_2flc3x3w85.s[64]++;

                this.count = i;
                cov_2flc3x3w85.s[65]++;
                this.emitter.emit({ transactions: this.count });
            } else {
                cov_2flc3x3w85.b[12][1]++;
            }
        }
    }]);

    return TransactionCounter;
}();