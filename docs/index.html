<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- <link rel="icon" href="../../../../favicon.ico"> -->
    <!-- Angular Components  -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.js"></script>
    <script src="https://cdn.firebase.com/libs/angularfire/0.8.0/angularfire.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.3/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-app.js"></script>
    <link rel='stylesheet' id='cryptocoins-css'  href='./css/cryptocoins.css'> 
    <link rel='stylesheet' id='custom-css'  href='./css/style.css'> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script type="text/javascript" src="https://checkout.stripe.com/checkout.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.3/firebase-functions.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase-messaging.js"></script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script src="https://rawgit.com/VividCortex/angular-recaptcha/master/release/angular-recaptcha.js"></script>
    <script type="text/javascript" src="scripts/qrcode.js"></script>
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,700|PT+Serif', rel='stylesheet'>
    <link href='//fonts.googleapis.com/css?family=Roboto+Condensed:400,700', rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css?family=Kanit" rel="stylesheet">


  </head>

  <body ng-app="donationsManager">

    <div class="container" ng-controller="donationsCtrl">

        <div class="modeSelect hidden">
            <h1>Cash or Crypto?</h1>
            <p class="errorMessage">{{errorMessage}}</p>
            <div class="modeSelectButton">
                <button class="radioSet modeSelect" ng-click="setMode('cash')">
                    <br>
                    <i class="fa fa-dollar"></i>
                    <h3>Cash</h3>
                </button>
            </div>
            <div class="modeSelectButton">
                <button class="radioSet modeSelect" ng-click="setMode('crypto')">
                    <br>
                    <i class="fa fa-bitcoin"></i>
                    <h3>Crypto</h3>
                </button>
            </div>
            <br>         
        </div>

        <div class="currencySelect {{display[0]}}">
            <h1>Select a currency:</h1>
            <p class="errorMessage">{{errorMessage}}</p>
            <input class="form-control" class="container-fluid" type="text" placeholder="Start typing to filter currency choices" id="search" ng-model="searchBarText" ng-keyup="search();"><hr>
                <div  ng-repeat="x in set" class="currencySelectButton">
                    <button id="{{x.code}}_button" class="radioSet currencySelect {{x.selected}}" ng-click="setCurrency(x.code)">
                        <br>
                        <i class="cc {{x.code}}"></i>
                        <h3>{{x.name}}<br>({{x.code}})</h3>
                    </button>
                </div>
            <br>         
            <p class="selectedCurrency">Currency: {{currency}}</p> 
            <h1>Donation Amount ($USD):</h1>
            <div class="donationAmountInput">
                <span class="currencyTypeLabel">$</span><input class="donationAmount" ng-model="donationAmount" type="number" value="100.00" placeholder="100.00" min="0.01" step="0.01" max="5000">    
            </div>
            
            <button class="nextBtn" type="next" ng-click="next(1, checkCurrencyChoice)">Next</button>
        </div>

        <div class="taxReceipt {{display[1]}}">
            <h1>Would you like to receive a tax receipt for your donation?</h1>
            <br>
            <p class="errorMessage">{{errorMessage}}</p>
            <fieldset class="taxReceiptSelector">
                <input ng-click="showEmailFn()" type="checkbox" id="taxReceiptCheckBox" ng-model="taxReceipt" checked>
                <label for="taxReceiptCheckBox"> I would like a tax receipt</label><br>
                <div class="{{showEmail}}">
                    <h3>Please enter an email address so we can send you your receipt.</h3>
                    <input type="number" class="emailInput" id="taxReceiptEmail" ng-model="email" placeholder="email (optional)">
                </div>
            </fieldset>    
            <hr>
            <p>A tax receipt can be issued for any donation of more than $50. Tax receipts are valid in the US only. Please <a href="{{contactUrl}}">contact us</a> for more information.</p><br>
            
            <br>
            <button class="nextBtn" type="next" ng-click="back(2)">Back</button> 
            <button class="nextBtn" type="next" ng-click="next(2, checkTaxReceiptChoice)">Next</button> 
        </div>

        <div class="origin {{display[2]}}">
            <h1>Verify Country of Origin</h1>
            <br>
            <p class="errorMessage">{{errorMessage}}</p>
            <fieldset class="taxReceiptSelector">
                <input type="checkbox" id="countryOfOrigin" ng-model="countryOfOrigin" checked>
                <label for="countryOfOrigin"> I am not a current resident of any countries subject to sanctions by the United States Government, and my name does not appear in any of the lists maintained by the Office of Foreign Asset Controls. If you are unsure whether you appear on these lists, please use the search <a href="https://sanctionssearch.ofac.treas.gov/">here.</a></label>
            </fieldset>    
            <br>
            <button class="nextBtn" type="next" ng-click="back(3)">Back</button> 
            <button class="nextBtn" type="next" ng-click="next(3, checkCountryOfOriginVerification)">Next</button> 
        </div>  

        <div class="maxDonations {{display[3]}}">
            <h1>MAXIMUM DONATIONS</h1>
            <br>
            <p class="errorMessage">{{errorMessage}}</p>
            <fieldset class="taxReceiptSelector">
                <input type="checkbox" id="maximumDonation" ng-model="maximumDonation" checked>
                <label for="maximumDonation"> I am not and have not donated more than $5000 USD or cryptocurrency of equivalent value in the past year.</label>
            </fieldset>    
            <br>
            <button class="nextBtn" type="next" ng-click="back(4)">Back</button> 
            <button class="nextBtn" type="next" ng-click="next(4, checkMaximumDonationVerification)">Next</button> 
        </div>                        


        <div class="stripe {{display[4]}}">
             <h1>Please Choose a Donation Amount</h1>
            <span class="currencyTypeLabel">$</span><input class="donationAmount" ng-model="donationAmount" type="number" value="100.00" placeholder="100.00" min="0.01" step="0.01" max="5000">
            <a href="" ng-click="onStripe('pk_live_j9F9S8Av7YGE4VH0CH4y891l')"><button class="submitDonation">Pay with Stripe</button></a>
            <button class="nextBtn" type="next" ng-click="back(5)">Back</button> 
            
            <div class="securePaymentsMessage"><img src="/images/secure-stripe-payment-logo.png"></div>

        </div>

        <div class="reCaptcha {{display[5]}}">
            <h1>Please verify that you're human:</h1>
            <div
                vc-recaptcha
                theme="'light'"
                key="key"
                on-create="setWidgetId(widgetId)"
                on-success="setResponse(response)"
                on-expire="cbExpiration()"
            ></div>

            <br>            
            <button class="nextBtn" type="next" ng-click="back(6)">Back</button> 
            <button class="nextBtn" type="next" ng-click="next(6, checkCaptcha)">Next</button>           
        </div>


        <div class="qrcode {{display[6]}}">
            <h1> Scan the QR Code below to donate your funds:</h1>
            <canvas id="qrCode">
            </canvas>
            <hr>
            <div class="donationAmount">
                {{donationAmount}} in {{donationCurrency}}
            </div> 
            <br>
            <p>Address: {{address}}</p>
            <button class="nextBtn" type="next" ng-click="back(7)">Back</button> 
            <button class="nextBtn" type="next" ng-click="next(7)">Next</button> 
            <div class="securePaymentsMessage"><h3>Secure payments powered by</h3><img src="/images/coinpayments-logo.png"></div>            

        </div>


        <div class="thanks {{display[7]}}">
            <h1>Thanks for your contribution.</h1>
            <p>Your donation helps keep the institute strong. Our team couldn't do it without you! <br> If you selected the option to receive a tax receipt, please stay posted and you should receive an email from a member of our staff shortly.</p>
            
            <br>

            <button class="nextBtn" type="next" ng-click="done()" >Done</button> 
        </div>        

    </div>
  </body>


  <footer>
          <script type="text/javascript" src="donationCtrl.js" defer></script>
  </footer>